<script is:inline>
  const darkModeMediaQuery = window.matchMedia("(prefers-color-scheme: dark)");

  function getTheme() {
    // Theme could be "dark", "light", or "system"
    const theme =
      localStorage.getItem("theme") ??
      (darkModeMediaQuery.matches ? "dark" : "light");

    return theme;
  }

  const theme = getTheme();

  if (theme === "dark") {
    document.documentElement.classList.add("dark");
  } else if (theme === "light") {
    document.documentElement.classList.remove("dark");
  } else if (theme === "system") {
    const isDarkMode = darkModeMediaQuery.matches;
    document.documentElement.classList.toggle("dark", isDarkMode);
  }

  darkModeMediaQuery.addEventListener("change", (e) => {
    const theme = getTheme();

    if (theme === "system") {
      const darkModeOn = e.matches;
      document.documentElement.classList.toggle("dark", darkModeOn);
    }
  });
</script>
